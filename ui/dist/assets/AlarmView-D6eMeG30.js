import{a as U,d as C,f as V}from"./date-W8Ww_3Ys.js";import{X as d,d as E,p as x,o as f,l as a,g as i,u as e,v as j,H as w,w as p,s as h,q as I,T as M,J as H,r as k,Z as J,k as Q,c as X}from"./index-BWQiikOf.js";import{_ as N}from"./DataTable.vuevuetypescriptsetuptruelang-B7Fb9BNZ.js";import{_ as S}from"./index-CvEIS6KB.js";import{L as K,_ as Z}from"./PageContainer.vuevuetypescriptsetuptruelang-BMnOwmiV.js";import{C as $}from"./circle-alert-Dx4xwqRq.js";import{c as L}from"./http-Z9rgl52c.js";import{R as P}from"./refresh-cw-W9-Cl0tn.js";import{a as G,b as O}from"./use-alarm-B8po5Bu7.js";import{u as W}from"./confirmation-store-PDxi_0BG.js";import{_ as Y,a as D,b as T,c as ee}from"./TabsTrigger.vuevuetypescriptsetuptruelang-CQFP6i1P.js";import"./PaginationPrev.vuevuetypescriptsetuptruelang-DSVlvR2e.js";import"./useForwardPropsEmits-BdCRpJMf.js";import"./SelectValue.vuevuetypescriptsetuptruelang-DIL7_Wf9.js";import"./check-CQqiH5K1.js";import"./useFormControl-lm5GEZvp.js";import"./SelectGroup.vuevuetypescriptsetuptruelang-vQTZ7daw.js";import"./RovingFocusGroup-BbHuxOEQ.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=L("circle-minus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=L("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function se(s){const n=C().diff(C(s),"second");return V(n)}const ie=[{accessorKey:"name",header:()=>d("div",{class:"text-xs"},"Name"),cell:({row:s})=>s.original.type},{accessorKey:"message",header:()=>d("div",{class:"text-xs"},"Message"),cell:({row:s})=>d("div",{class:"max-w-96"},s.original.message)},{accessorKey:"activatedAt",header:()=>d("div",{class:"text-xs"},"Activated At"),cell:({row:s})=>U(s.original.activatedAt)},{accessorKey:"duration",header:()=>d("div",{class:"text-xs"},"Duration"),cell:({row:s})=>se(s.original.activatedAt)}],oe={key:0,class:"flex flex-col gap-4 justify-center items-center pt-20"},le={class:"flex gap-4 items-center"},re={key:1,class:"flex flex-col gap-4 justify-center items-center pt-20"},ne={class:"flex flex-col gap-4 items-center p-6 text-red-500"},de={class:"space-y-2 text-center"},ce={class:"text-sm text-muted-foreground"},pe={key:2,class:"flex flex-col gap-4 justify-center items-center pt-20"},me={class:"flex flex-col gap-4 items-center p-6"},ue={key:3,class:"flex flex-col w-full"},ge={class:"flex justify-end items-center mb-6"},fe={class:"flex gap-2 items-center"},xe=E({__name:"ActiveAlarmTabContent",props:{page:{},pageSize:{},data:{},totalItems:{},isFetching:{type:Boolean},isPending:{type:Boolean},isError:{type:Boolean},error:{}},emits:["update:page","update:pageSize","update:data"],setup(s,{emit:n}){const t=s,r=n,m=w();return(y,o)=>{var u;return t.isPending?(f(),x("div",oe,[a("div",le,[i(e(K),{class:"animate-spin size-8 text-muted-foreground"})]),o[4]||(o[4]=a("p",{class:"text-lg text-muted-foreground"}," Loading alarms... ",-1))])):t.isError?(f(),x("div",re,[a("div",ne,[i(e($),{class:"size-8"}),a("div",de,[o[5]||(o[5]=a("h2",{class:"text-lg font-semibold"}," Failed to load alarms ",-1)),a("p",ce,j(((u=t.error)==null?void 0:u.message)||"An unexpected error occurred"),1)])])])):t.data?(f(),x("div",ue,[a("div",ge,[a("div",fe,[i(e(S),{variant:"outline",onClick:o[0]||(o[0]=()=>e(m).push("/monitoring"))},{default:p(()=>[i(e(ae),{class:"size-4"}),o[7]||(o[7]=h(" Settings "))]),_:1,__:[7]}),i(e(S),{variant:"outline",disabled:t.isFetching,onClick:o[1]||(o[1]=c=>r("update:data"))},{default:p(()=>[i(e(P),{class:I(["mr-2 size-4",{"animate-spin":t.isFetching}])},null,8,["class"]),o[8]||(o[8]=h(" Refresh "))]),_:1,__:[8]},8,["disabled"])])]),i(N,{page:t.page,"page-size":t.pageSize,columns:e(ie),data:t.data,"total-items":t.totalItems,"is-loading":t.isFetching,"onUpdate:page":o[2]||(o[2]=c=>r("update:page",c)),"onUpdate:pageSize":o[3]||(o[3]=c=>r("update:pageSize",c))},null,8,["page","page-size","columns","data","total-items","is-loading"])])):(f(),x("div",pe,[a("div",me,[i(e($),{class:"size-8 text-muted-foreground"}),o[6]||(o[6]=a("div",{class:"space-y-2 text-center"},[a("h2",{class:"text-lg font-semibold"}," No alarms active found "),a("p",{class:"text-sm text-muted-foreground"}," There are no alarms to display ")],-1))])]))}}});function ve(s){const n=C().diff(C(s),"second");return V(n)}const ye=[{accessorKey:"name",header:()=>d("div",{class:"text-xs"},"Name"),cell:({row:s})=>s.original.type},{accessorKey:"message",header:()=>d("div",{class:"text-xs"},"Message"),cell:({row:s})=>d("div",{class:"max-w-96"},s.original.message)},{accessorKey:"time",header:()=>d("div",{class:"text-xs"},"Time"),cell:({row:s})=>d("div",{class:"flex flex-col"},[d("span",null,U(s.original.activatedAt)),d("span",null,s.original.deactivatedAt?U(s.original.deactivatedAt):"-")])},{accessorKey:"duration",header:()=>d("div",{class:"text-xs"},"Duration"),cell:({row:s})=>ve(s.original.activatedAt)}],_e={key:0,class:"flex flex-col gap-4 justify-center items-center pt-20"},he={class:"flex gap-4 items-center"},ze={key:1,class:"flex flex-col gap-4 justify-center items-center pt-20"},Ae={class:"flex flex-col gap-4 items-center p-6 text-red-500"},be={class:"space-y-2 text-center"},Ce={class:"text-sm text-muted-foreground"},Se={key:2,class:"flex flex-col gap-4 justify-center items-center pt-20"},$e={class:"flex flex-col gap-4 items-center p-6"},ke={key:3,class:"flex flex-col w-full"},Ue={class:"flex justify-end items-center mb-6"},Ee={class:"flex gap-2 items-center"},Fe=E({__name:"AlarmHistoryTabContent",props:{page:{},pageSize:{},data:{},totalItems:{},isFetching:{type:Boolean},isPending:{type:Boolean},isError:{type:Boolean},error:{}},emits:["update:page","update:pageSize","update:data"],setup(s,{emit:n}){const t=s,r=n,{openConfirmation:m}=W(),{mutate:y,isPending:o}=G();function u(){m({title:"Clear alarm history",description:"Are you sure you want to clear all alarm history?",actionLabel:"Confirm",cancelLabel:"Cancel",onAction:()=>{y(void 0,{onSuccess:()=>{r("update:data")},onError:c=>{c instanceof M&&H.error(c.message)}})},onCancel:()=>{}})}return(c,l)=>{var z;return c.isPending?(f(),x("div",_e,[a("div",he,[i(e(K),{class:"animate-spin size-8 text-muted-foreground"})]),l[3]||(l[3]=a("p",{class:"text-lg text-muted-foreground"}," Loading alarms... ",-1))])):t.isError?(f(),x("div",ze,[a("div",Ae,[i(e($),{class:"size-8"}),a("div",be,[l[4]||(l[4]=a("h2",{class:"text-lg font-semibold"}," Failed to load alarms ",-1)),a("p",Ce,j(((z=t.error)==null?void 0:z.message)||"An unexpected error occurred"),1)])])])):!t.data||t.data.length===0?(f(),x("div",Se,[a("div",$e,[i(e($),{class:"size-8 text-muted-foreground"}),l[5]||(l[5]=a("div",{class:"space-y-2 text-center"},[a("h2",{class:"text-lg font-semibold"}," No alarms active found "),a("p",{class:"text-sm text-muted-foreground"}," There are no alarms to display ")],-1))])])):(f(),x("div",ke,[a("div",Ue,[a("div",Ee,[i(e(S),{variant:"outline",class:"!text-destructive border-destructive",disabled:e(o),onClick:u},{default:p(()=>[i(e(te),{class:"mr-2 size-4"}),l[6]||(l[6]=h(" Clear History Alarms "))]),_:1,__:[6]},8,["disabled"]),i(e(S),{variant:"outline",disabled:t.isFetching,onClick:l[0]||(l[0]=v=>r("update:data"))},{default:p(()=>[i(e(P),{class:I(["mr-2 size-4",{"animate-spin":t.isFetching}])},null,8,["class"]),l[7]||(l[7]=h(" Refresh "))]),_:1,__:[7]},8,["disabled"])])]),i(N,{page:t.page,"page-size":t.pageSize,columns:e(ye),data:t.data,"total-items":t.totalItems,"is-loading":t.isFetching,"onUpdate:page":l[1]||(l[1]=v=>r("update:page",v)),"onUpdate:pageSize":l[2]||(l[2]=v=>r("update:pageSize",v))},null,8,["page","page-size","columns","data","total-items","is-loading"])]))}}}),Ze=E({__name:"AlarmView",setup(s){const n=J(),t=w(),r=k(Number(n.query.page)||1),m=k(Number(n.query.pageSize)||10),y=k(n.query.tab??"active"),o=Q(()=>y.value==="history"?"DEACTIVE":"ACTIVE"),{data:u,isFetching:c,isPending:l,isError:z,error:v,refetch:F}=O(r,m,o);function R(g){y.value=g.toString(),r.value=1,m.value=10,t.replace({query:{tab:g}})}function q(g){r.value=g,t.replace({query:{...n.query,page:g.toString()}})}function B(g){m.value=g,r.value=1,t.replace({query:{...n.query,pageSize:g.toString(),page:"1"}})}return(g,_)=>(f(),X(Z,null,{default:p(()=>[_[2]||(_[2]=a("div",null,[a("h1",{class:"text-xl font-semibold tracking-tight"}," Alarm "),a("p",{class:"text-sm text-muted-foreground"}," View alarms ")],-1)),i(e(ee),{"default-value":e(y),"onUpdate:modelValue":R},{default:p(()=>[i(e(Y),null,{default:p(()=>[i(e(D),{value:"active"},{default:p(()=>_[0]||(_[0]=[h(" Active ")])),_:1,__:[0]}),i(e(D),{value:"history"},{default:p(()=>_[1]||(_[1]=[h(" History ")])),_:1,__:[1]})]),_:1}),i(e(T),{value:"active"},{default:p(()=>{var A,b;return[i(xe,{page:e(r),"page-size":e(m),data:((A=e(u))==null?void 0:A.items)??[],"total-items":((b=e(u))==null?void 0:b.totalItems)??0,"is-fetching":e(c),"is-pending":e(l),"is-error":e(z),error:e(v),"onUpdate:page":q,"onUpdate:pageSize":B,"onUpdate:data":e(F)},null,8,["page","page-size","data","total-items","is-fetching","is-pending","is-error","error","onUpdate:data"])]}),_:1}),i(e(T),{value:"history"},{default:p(()=>{var A,b;return[i(Fe,{page:e(r),"page-size":e(m),data:((A=e(u))==null?void 0:A.items)??[],"total-items":((b=e(u))==null?void 0:b.totalItems)??0,"is-fetching":e(c),"is-pending":e(l),"is-error":e(z),error:e(v),"onUpdate:page":q,"onUpdate:pageSize":B,"onUpdate:data":e(F)},null,8,["page","page-size","data","total-items","is-fetching","is-pending","is-error","error","onUpdate:data"])]}),_:1})]),_:1},8,["default-value"])]),_:1,__:[2]}))}});export{Ze as default};
